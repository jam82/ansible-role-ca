---
# role: ansible-role-ca
# file: defaults/main.yml

# The role is disabled by default, so you do not get in trouble.
# Checked in tasks/main.yml which uses a tasks block if enabled.
ca_role_enabled: false

# The hierarchy of CA(s), used to create the CA certificate(s).
# Can be one CA certificate for all activities or multi tier CA structure.
# The example here creates a 3-tier CA, with:
#   - Root CA: used to sign intermediate, kept on domain controller
#     - Intermediate CA:  used to sign the signing CAs
#       - Component CA: signing CA for servers, routers, switches, etc.
#       - Identity CA: signing CA for users (email encryption, signature and identity)
#       - Automation CA: intended as root for StepCA, short lived component certs
# USES:
#   - ansible.community.crypto.openssl_csr
#   - ansible.community.crypto.x509_certificate
# CUSTOM ATTRIBUTES:
#   - name:     self selected name
#   - parent:   path of parent CA.
#   - pathlen:  path length for hierarchy, for signing CA this is 0.
#               Could also be called 'depth' of hierarchy,
#               or distance beetween top level CA and certificates.
# for the rest see:
# https://docs.ansible.com/ansible/latest/collections/community/crypto/openssl_csr_module.html
ca_info:
  country: "DE"
  state: "Bayern"
  locality: "Erlangen"
  organization: "Homebase"
  organizational_unit: ""
  url: "https://pki.samdom.localdomain"
  email: "pki@samdom.localdomain"
  path: "/opt/ca"
  default_md: "sha512"
  default_algorithm: "rsa"
  default_key_length: 4096

ca_list:
  - id: 0
    name: "Homebase Root CA 2021"
    path: "root"
    password: "Sup3rSecr3t0+"
    parent: 0
    method: "selfsign"
    state: "present"
    parameters:
      pathlen: 2
  - id: 1
    name: "Homebase Intermediate CA 2021"
    password: "Sup3rSecr3t0+"
    path: "intermediate"
    parent: 0
    method: "sign"
    state: "present"
    parameters:
      pathlen: 1
  - id: 2
    name: "Homebase Component CA 2021"
    password: "Sup3rSecr3t0+"
    path: "component"
    parent: 1
    method: "sign"
    state: "present"
    parameters:
      pathlen: 0
  - id: 3
    name: "Homebase User CA 2021"
    password: "Sup3rSecr3t0+"
    path: "user"
    parent: 1
    method: "sign"
    state: "present"
    parameters:
      pathlen: 0
